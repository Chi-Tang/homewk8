<html><head>
<title>萬年曆國(農)曆查天干地支相關文章：聖嚴法師108自在語(一)</title>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<meta name="Descroption" content="天文與曆法資料引用www.bieyu.com">
<meta name=keywords content="亂數表卦象;萬年曆;紫微斗數;易經八卦;陽宅風水 ;高中數學;農(陽)曆;節氣;天干地支;生肖;徐其堂老師休閒園地">

<script language="JavaScript">

var SND =Array("為為善惡在一念間、修修福慧於方寸中。","星星之火足以燎原、小小善願能救世界。","天地有作育大德、我豈無慈悲宏願。",
"救度眾生是提起、不住著相是放下。","漫天紅塵心勿染、遍地荊棘杖竹行。",
"慈悲必春風化雨、智慧當日光普照。","悲善拔苦慈予樂、智火滅罪慧斷惑。","有大智慧有大願、無量福德無量壽。",
"若見心中如來藏、三界火宅化紅蓮。","應無所住而生其心、是入慈悲門。",
"道心之中有施無畏。","放下萬緣時、眾生一肩挑。",
"安寧身心靈、安定家與業。","南山老松早已衰老、北斗壽星尚甚年輕。",
"神龍潛藏深潭大澤、猛虎高臥危崖險窟。","佛法無他、只有壹味、自利利人的解脫味也。",
"常念觀音菩薩、心安就有平安。","朝山禮拜來修行、祈福消災願易成；口唱耳聽心恭敬、三步一拜向前行；身心舒暢好感應、業消障除福慧增。",
"一乞食千家飯、孤僧杖竹萬里遊；隨緣應化莫擁有、緣畢放身撒兩手。","放下不等放棄、是為脫困、是為提起；要能放下才能提起、提放自如是自在人。",
"遇事正面解讀逆向思考、成事確立方向鍥而不捨。","路遇懸崖峭壁走過去、巧過人間仙境莫逗留。",
"權勢財富屬社會共享、禍福苦樂乃各人因緣。","誘以名利權位不動心、陷於千軍萬馬無所懼。",
"天不錯地不錯是心錯、他有理你有理我沒理。","莫怨孝子賢孫何其少、但問養育兒女怎麼教。",
"學問的領域重在研究、經驗的範疇則為實踐。","漫漫長夜無夢春宵短、茫茫苦海有船彼岸近。",
"倚般若杵碎萬千障礙、運福德斧建人間淨土。","駕行般若船苦海普渡、常登涅槃山心性不動。",
"河山猶在、景物遷移；日月長運、人事全非。","天上人間樂與苦、自心造作自身受。",
"青山綠水廣長舌、鳥語花香說妙法。","教育為千秋大業、賢能乃百代楷模。",
"水深千丈終見底、山高萬里海中昇。","雲門日日是好日、行腳步步履芳草。",
"世間本無垢與淨、祇緣自起分別心。","夕陽西下明天見、旭日東昇近黃昏。",
"戲外看戲忘了戲、夢中作夢不知夢。","雨露霜雪本無主、風雲雷電應時現。",
"危機化為轉機時、絕路走出活路人。","天堂地獄由心造、成佛作祖心外無。",
"驚覺執迷已近悟、知迷不悟錯中錯。","人生若夢誰都會說、終生作夢怎麼不醒。",
"百千計畫忙碌一生、萬緣放下前程似錦。","臨渴掘井緩不濟急、即時學佛即時解惑。",
"勿因有事而憂、寧為無事而喜。","禪法即是心法、萬法由心生滅。",
"大夢誰先覺、離夢想顛倒。","人上有人、山高水長。",
"走路健康鍊身、更可修行鍊心、快走驅遣妄情、慢走發慧習定。","月缺月圓日、若晦若明時；風雨無月夜、月亮本常明。",
"世俗境：身如玉樹臨風、心如平湖秋月。","修行境：身是菩提樹、心如明鏡臺。",
"悟後境：菩提本無樹、明鏡亦非臺。","有相無相有無相、真空假空真假空。",
"交友應交直諒多聞、信佛當避怪力亂神、學法幸勿到處摸門、敬僧切忌盲從個人。","多福少福當培福、知恩念恩必報恩。",
"慈悲心化解怨敵、智慧心驅除煩惱。","恭敬心護持三寶、清淨心弘法利生。",
"感恩心體驗生活、精進心善用生命。","慚愧心增長福德、懺悔心消滅罪障。",
"懷恩報恩恩相續、飲水思源源不絕。","堅韌心易度難關、長遠心可成大事。",
"你心我心同佛心、知福惜福多培福。","涓滴之恩湧泉以饋、一飯之施粉身相報。",
"取水飲水以水飲人、受恩謝恩用恩謝人。","解開愛恨情仇心結、學習慈悲喜捨心量。",
"父母之恩重於天地、三寶之德多過恆沙。","知恩報恩是飲水思源、恩情糾結會相互傷害。",
"感恩是終生受用的福報、懷恨乃永世糾纏的魔障。","若不善用財富利益世人、便像錦衣夜行暗自驕矜。",
"布施是經營財富的價值、種福乃過手財富的原因。","家業百年不墜因為積福、富貴不過三代由於自私。",
"隨時服務他人、終生幸福；有力不結善緣、後悔莫及。","看天播種時、耘草施肥日、豐收感恩月、祈求年年好年。",
"人生所求四大美事為：求福當先種福、培福、惜福；求祿當先廣結善緣；求壽當常保健；求喜先應笑面迎人。","以慚愧心反觀自己、時時覺得於己於人總是努力不足奉獻不夠。",
"以慚愧心觀照本身為人、做人若不自我省察檢點邪正、隨時有失足之危。","用感恩心看待世界事物、做人若不感恩圖報以奉獻世界、活水便會枯竭。",
"百年相守、相互尊敬感恩、相互學習所長、相互原諒缺失、相互關愛扶持。","真誠必有應、精勤萬事成。",
"寧以勤勉補笨拙、勿仗聰明而懈怠。","嚴以律己不虧損、寬以待人受益多。",
"守貧望富當勤儉、處亂守安不動心。","菜根清香布衣暖、勤勞健康節儉富。",
"及時行樂乃浪漫、隨處修善積功德。","能中更有能中手、各自努力莫羨人。",
"聽諍言未必順耳、嚐苦味的是良藥。","枯旱祈降及時雨、隆冬願作送暖人。",
"鳳凰好棲富貴宅、白鶴喜落福壽家。","心中不存得失想、常作世間無事人。",
"才德兼備是賢良、有能無德害群馬。","知過即改不為恥、放下屠刀立成佛。",
"警惕富貴不出三代、小心權勢令人墮落。","自古將相多出寒門、捨己為公天下太平。",
"少些人我是非的執著、多點成人之美的言行。","若望常保富貴、培福要緊、富貴多從積福來。",
"受持觀世音菩薩名號、得無量無邊福德之利。","爭奪他人飯碗莫如自家耕田、自家無田可耕幫人耕田也好。",
"常喫謙虛恭敬恕忍寬厚的飯、多喝誠實禮讓勤勞節儉之湯。","一夜致富是暴富、一夕成名乃虛名、暴富暴發富難守、虛名不實名累人。",
"知音難遇正常事、勿因孤獨不理人；少煩少惱福德長、多思多慮障礙增。","多心防人易遭鬼、知己知彼逢貴人、富貴貧賤皆布施、自利利人利眾生。",
"人生在世、當備四得：生得其所、老得其福、病得健康、死得其時、萬千幸福在其中矣。","富貴未必只三代、賢哲未必生於寒門；富貴當積德、寒門須勤勉。",
"行善沒有條件。","珍惜生命、為自己加油。");

var XLunData=new Array(
"h0A4D0","h0D250","h1D295","h0B550","h056A0","h0ADA2","h095B0","h14977","h049B0","h0A4B0",
"h0B4B5","h06A50","h06D40","h1AB54","h02B60","h09570","h052F2","h04970","h06566","h0D4A0",
"h0EA50","h16A95","h05AD0","h02B60","h186E3","h092E0","h1C8D7","h0C950","h0D4A0","h1D8A6",
"h0B550","h056A0","h1A5B4","h025D0","h092D0","h0D2B2","h0A950","h0B557","h06CA0","h0B550",
"h15355","h04DA0","h0A5B0","h14573","h052B0","h0A9A8","h0E950","h06AA0","h0AEA6","h0AB50",
"h04B60","h0AAE4","h0A570","h05260","h0F263","h0D950","h05B57","h056A0","h096D0","h04DD5",
"h04AD0","h0A4D0","h0D4D4","h0D250","h0D558","h0B540","h0B6A0","h195A6","h095B0","h049B0",
"h0A974","h0A4B0","h0B27A","h06A50","h06D40","h0AF46","h0AB60","h09570","h04AF5","h04970",
"h064B0","h074A3","h0EA50","h06B58","h05AC0","h0AB60","h096D5","h092E0","h0C960","h0D954",
"h0D4A0","h0DA50","h07552","h056A0","h0ABB7","h025D0","h092D0","h0CAB5","h0A950","h0B4A0",
"h0BAA4","h0AD50","h055D9","h04BA0","h0A5B0","h15176","h052B0","h06930","h07954","h06AA0",
"h0AD50","h05B52","h04B60","h0A6E6","h0A4E0","h0D260","h0EA65","h0D520","h0DAA0","h076A3",
"h096D0","h04AFB","h04AD0","h0A4D0","h1D0B6","h0D250","h0D520","h0DD45","h0B5A0","h056D0",
"h055B2","h049B0","h0A577","h0A4B0","h0AA50","h1B255","h06D20","h0ADA0","h14B63","h09370",
"h049F8","h04970","h064B0","h168A6","h0EA50","h06B20","h1A6C4","h0AAE0","h092E0","h0D2E3",
"h0C960","h0D557","h0D4A0","h0DA50","h05D55","h056A0","h0A6D0","h055D4","h052D0","h0A9B8");
//////////////////////////////////////////////////////////////////////////////////////////////////
var Today = new Date();
var Ny = Today.getFullYear();
var Nm = Today.getMonth();
var Nd = Today.getDate();
var cld,Selday;
var NHoliday = new Array(
"0101*元旦", "0111 司法節","0115 藥師節","0123 自由日","0204 農民節","0214 情人節",
"0215 戲劇節","0219 新生活運動紀念日","0228*和平紀念日","0301 兵役節","0305 童子軍節",
"0308 婦女節","0312 植樹節","0317 國醫節","0320 郵政節","0321 氣象節","0325 美術節",
"0326 廣播節","0329 青年節","0330 出版節","0401 愚人節","0404 婦幼節","0405 音樂節",
"0407 衛生節","0422 世界地球日","0501*勞動節","0504 文藝節","0505 舞蹈節","0510 珠算節",
"0512 護士節","0603 禁煙節","0606 工程師節","0609 鐵路節","0615 警察節","0630 會計師節",
"0701 漁民節","0711 航海節","0712 聾啞節","0808 父親節","0814 空軍節","0827 鄭成功誕辰",
"0901 記者節","0903 軍人節","0909 體育節","0913 法律日","0928 教師節","1006 老人節",
"1010*國慶紀念日","1021 華僑節","1025 台灣光復節","1031 萬聖節","1101 商人節","1111 工業節",
"1117 自來水節","1112 國父誕辰日","1121 防空節","1205 海員節","1210 人權節","1212 憲兵節",
"1225 行憲紀念日","1227 建築師節","1228 電信節","1231 受信節");
var WHoliday = new Array(
"0520 母親節","0716 合作節","0730 被奴役國家週","1144 感恩節");
var LHoliday = new Array(
"0101*春節","0102*回娘家","0103*祭祖","0104 迎神","0105 開市","0109 天公生","0115 元宵節","0202 頭牙",
"0323 媽祖生","0408 浴佛節","0505*端午節","0701 開鬼門","0707 七夕情人節","0715 中元節","0800 關鬼門",
"0815*中秋節","0909 重陽節","1208 臘八節","1216 尾牙","1224 送神","0100*除夕");

function initialize() {
var Today = new Date();
var Ny = Today.getFullYear();
var Nm = Today.getMonth()+1;
var Nd = Today.getDate();
var fweek = Today.getDay();
 CLD.SY.selectedIndex=Ny-1912;  
 CLD.SM.selectedIndex = Nm-1;
  // CLD.SM.selectedIndex=Nm;    // Today.getMonth();month =0,1,2,3....
    //Selday = Nd - fweek + 1;
 Selday = Nd ;
drawCld(Ny, Nm);
}
var NMonthDays=new Array(31,28,31,30,31,30,31,31,30,31,30,31);
function isLeapYear(y,m) {
 if(m==1)
    return(((y%4 == 0) && (y%100 != 0) || (y%400 == 0))? 29: 28);
 else
    return(NMonthDays[m]);
}
    /////////////////////////////////////////////////////////////////////////////////////////
   //script language=javascript>
    var synmonth = 29.530588853;     //synodic month (new Moon to new Moon)
    var ptsa = new Array(485, 203, 199, 182, 156, 136, 77, 74, 70, 58, 52, 50, 45, 44, 29, 18, 17, 16, 14, 12, 12, 12, 9, 8);
    var ptsb = new Array(324.96, 337.23, 342.08, 27.85, 73.14, 171.52, 222.54, 296.72, 243.58, 119.81, 297.17, 21.02, 247.54, 325.15, 60.93, 155.12, 288.79, 198.04, 199.76, 95.39, 287.11, 320.81, 227.73, 15.45);
    var ptsc = new Array(1934.136, 32964.467, 20.186, 445267.112, 45036.886, 22518.443, 65928.934, 3034.906, 9037.513, 33718.147, 150.678, 2281.226, 29929.562, 31555.956, 4443.417, 67555.328, 4562.452, 62894.029, 31436.921, 14577.848, 31931.756, 34777.259, 1222.114, 16859.074);
    var ctg = new Array("甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸");
    var cdz = new Array("子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥");
    var wkd = new Array("日", "一", "二", "三", "四", "五", "六");
    var jdez = new Array;
// function SoLuGzJd() {	//此程式功能為顯示整月陽曆陰曆干支曆儒略日對照。此程式適用範圍為-1000至3000年
   var dStr1 = new Array('日', '一', '二', '三', '四', '五', '六', '七', '八', '九', '十');
    var Zodiac = new Array("鼠", "牛", "虎", "兔", "龍", "蛇", "馬", "羊", "猴", "雞", "狗", "豬");
    var Gan = new Array("甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸");
    var Zhi = new Array("子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥");
    function GanZhi(num) {
        return (Gan[num % 10] + Zhi[num % 12]);
       }

    function calElement(sYear, sMonth, sDay, week, lYear, lMonth, lDay, isLeap, cYear, cMonth, cDay, cZod, jdstr, lHliday) {
        this.isToday = false;
        this.sYear = sYear;
        this.sMonth = sMonth;
        this.sDay = sDay;
        this.week = week;
        this.lYear = lYear;
        this.lMonth = lMonth;
        this.lDay = lDay;
        this.isLeap = isLeap;
        this.cYear = cYear;
        this.cMonth = cMonth;
       // this.jMonth = jMonth;
        this.cDay = cDay;
        this.cZod = cZod;
        this.jdstr = jdstr;
        this.lHliday = lHliday;
        this.color = '';
        this.Lholiday = '';
        this.Nholiday = '';
        this.solarTerms = '';
       }
   
    var SolarTerm = new Array("小寒", "大寒", "立春", "雨水", "驚蟄", "春分", "清明", "穀雨", "立夏", "小滿", "芒種", "夏至", "小暑", "大暑", "立秋", "處暑", "白露", "秋分", "寒露", "霜降", "立冬", "小雪", "大雪", "冬至");
   ////var dStr1 = new Array('日', '一', '二', '三', '四', '五', '六', '七', '八', '九', '十');
     function calendar(y, m) {
        // var TWNSTR = new Array("轸", "角", "亢", "氐", "房", "心", "尾", "箕", "斗", "牛", "女", "虛", "危", "室", "壁", "奎", "娄", "胃", "昴", "毕", "觜", "参", "井", "鬼", "柳", "星", "张", "翼", "轸")
         var TWNSTR = new Array("轸", "角", "亢", "氐", "房", "心", "尾", "箕", "斗", "牛", "女", "虛", "危", "室", "壁", "奎", "娄", "胃", "昴", "毕", "觜", "参", "井", "鬼", "柳", "星", "张", "翼", "轸");
         ///var TOETT = TOETA((DDtD3 + 19) Mod 28)
        var tst1;
        tst1 = "hellow";
        var sDObj, lDObj, Ly, Lm, Ld = 1, Lp, Lx = 0, tmp1, tmp2, tmp3;
        var Cy, Cm, Jm, Cd, Cz;
        var Ldpos = new Array(3);
        var n = 0;
        var firstLM = 0 , lastdLM = 0 ,ILpm =-1 ;
        sDObj = new Date(y, m-1, 1, 0, 0, 0, 0);
        this.length = isLeapYear(y, m-1);
        this.firstWeek = sDObj.getDay();
        /////////////////////////////////////////////////////////////////////////
        //陽曆的各變數
            var yea, zr = new Array, jdt, jdx, djd = new Array, jr = new Array, ty;
            var tg = new Array, dz = new Array, dayjd, op, dom, kk;
        //陰曆的各變數
            var IL, CYY, CMM, CDD, Czod, jdstr,lHliday;
            var pod;
            var sjd = new Array, mc = new Array, lsjd, mis;
        //取得輸入之陽曆年月值
            var ldta = new Array;
            var yea = y;
            var mx = m;
        //var yea = in1.value - 0;	//取得年之輸入值
        // var mx = in2.value - 0;	//取得月之輸入值
            var dx = 1;	//從每月的1日開始列印
            var flag = 0;
            var out = "";
        //限定範圍
            if (yea < -7000 || yea > 7000) {
                alert("超出計算能力");
                return false;
            }
            if (yea < -1000 || yea > 3000) {
                alert("适用于西元-1000年至西元3000年，超出此范围误差较大");
            }

        //驗證輸入日期的正確性,若不正確則跳離
           if (ValidDate(op, yea, mx, dx) == false) { return false; }
        //  op = false;    //note gobal variable location
            GetZQandSMandLunarMonthCode(op, yea, zr, sjd, mc);
            var jdt = Jdays(op, yea, mx, dx, 12);    //求出指定年月日之JD值
           // alert(sjd[9]);
           // alert(mc[2].length);
         // alert(Jdays(false, 2000,1,1,12));
         //document.write("hellow");
         // document.write((jdt+20) % 28);
            if (Math.floor(jdt) < Math.floor(sjd[0] + 0.5)) { flag = 1; GetZQandSMandLunarMonthCode(op, yea - 1, zr, sjd, mc); }
            //將1582年10月的天數獨立處理
            if ((yea == 1582 && mx == 10) && (!op)) {
                dom = 20;
            } else {    //其餘的月份天數由下列公式算出
                atf = ((yea % 400 == 0) || (!((yea > 1582) || op) || !(yea % 100 == 0)) && (yea % 4 == 0)) && (mx == 2);
                dom = 30 + ((Math.abs(mx - 7.5) + 0.5) % 2) - 2 * (mx == 2) + atf;        //將每月最大日期對應到28,29,30或31
            }
            out += "       陽曆     星期        陰曆               干支曆          儒略日\r\n";
         for (kk = 0; kk <= dom - 1; kk++) {
             ///  for (kk = 1; kk <= dom ; kk++) {     //下面的指令中加0.5是為了改為從0時算起而不從正午算起   
                jdx = jdt + kk;
                for (i = 0; i <= 14; i++) {
                    //下面的指令中加0.5是為了改為從0時算起而不從正午算起
                    //下面的指令中加0.5是為了改為從0時算起而不從正午算起
                    if ((Math.floor(jdx) >= Math.floor(sjd[i] + 0.5)) && (Math.floor(jdx) < Math.floor(sjd[i + 1] + 0.5))) { mi = i; break; }
                }
                di = Math.floor(jdx) - Math.floor(sjd[mi] + 0.5) + 1;       //此處加1是因為每月初一從1開始而非從0開始
                if (mc[mi] < 2 || flag == 1) { yi = yea - 1; } else { yi = yea; }	//以月來調整年,因mc(mi)=0對應到前一年陰曆11月，mc(mi)=1對應到前一年陰曆12月，mc(mi)=2對應到本年1月，依此類推
              // alert("</br>10:" + (sjd[10] - sjd[9]) + "</br>11:" + (sjd[11] - sjd[10]) + "</br>12:" + (sjd[12] - sjd[11]) + "</br>13:" + (sjd[13] - sjd[12]) + "</br>:");
             //  alert(mi+":"+sjd[mi].);
             // if ((mc[mi] - Math.floor(mc[mi])) * 2 + 1 == 1) {ry = "　"; IL = false;} else { ry = "閏"; IL = true;}
             if ((mc[mi] - Math.floor(mc[mi])) * 2 + 1 == 1) {ry = "　"; IL = false;} else { ry = "閏"; IL = true; ILpm = mc[mi];}
                mis = (Math.floor(mc[mi] + 10) % 12) + 1;        //對應到月份

             //alert(IL + ':潤:' + mis);
            
                if ((yea == 1582 && mx == 10) && (!op) && (kk > 3)) { pod = kk + 11; } else { pod = kk + 1; }	//對應到日
                var yc1 = "     " + yea;
                yc1 = yc1.substr(yc1.length - 5, 5);
                var nyds1 = yc1; nyds1 += "年";
                nyds1 += ((mx < 10) ? " " : "") + mx + "月";
                nyds1 += ((pod < 10) ? " " : "") + pod + "日 ";
                out += nyds1;
                var wk = (((Math.floor(jdx + 1) % 7)) + 7) % 7;	//模數(或餘數)為0代表星期日。jda加1是因起始日為星期一
                out += wkd[wk] + "  ";
                var yc2 = "     " + yi;
                yc2 = yc2.substr(yc2.length - 5, 5);
                var nyds2 = yc2; nyds2 += "年";
                nyds2 += ry + ((mis < 10) ? " " : "") + mis + "月";
                nyds2 += ((di < 10) ? " " : "") + di + "日   ";
                out += nyds2;
                // document.write("hellow");
             // document.write(nyds2);
             //'''''下面的指令中減0.5是為了改為從0時算起而不從正午算起   
                GetGZ(op, jdx - 0.5, yea, ptsa, ptsb, ptsc, tg, dz);
                out += ctg[tg[0]] + cdz[dz[0]] + ctg[tg[1]] + cdz[dz[1]] + ctg[tg[2]] + cdz[dz[2]] + ctg[tg[3]] + cdz[dz[3]] + "   ";
                out += jdx - 0.5;
                out += "\r\n";
                // document.write(out);
                CYY = ctg[tg[0]] + cdz[dz[0]];
                CMM = ctg[tg[1]] + cdz[dz[1]];
                CDD = ctg[tg[2]] + cdz[dz[2]];
                Czod = Zodiac[dz[0]];
                // Czod = Zodiac[(yi - 1912 + 48) % 12];
               //this[i] = new calElement(y, m + 1, i + 1, dStr1[(i + this.firstWeek) % 7],
                //	    Ly, Lm, Ld++, Lp, Cy, Cm, Jm, Cd, Czod);
                // document.write(out);
                var lastdi = 0 ,lastdt;
                if (n == 0) firstLM = mis;
                if (kk == 0) { Ldpos[n++] = kk - di + 1; lastdi = kk - di + 1; }
                if (di == 1) { Ldpos[n++] = kk - di + 1; lastdi = kk - di + 1; }
               // var lastd1= 0 ,lastd2= 0 ;
               // if (kk == 0) Ldpos[0] = kk - di + 1;
               // if (di == 1) Ldpos[1] = kk - di + 1; 
                //if (lastd2 > 0 && IL != true) {
                var Lppt = (IL + ':潤:' + mc[mi]);
               // alert(ILpm);
              //  lastdLM = Math.floor(sjd[mc[mi]] ) ;  //LeaP=true mi =6,mc[mi]=5.5
                  //  lastdLM = mc[mis];
                    if (mc[mi] >= ILpm) {
                        lastdLM = Math.floor(sjd[mi + 1] + 0.5) - Math.floor(sjd[mi] + 0.5);
                    }
                    else {
                        lastdLM = Math.floor(sjd[mi] + 0.5) - Math.floor(sjd[mi - 1] + 0.5);
                    }
                 //  lastdLM = (Ldpos[1] - Ldpos[0]);    //(lastd2 - lastd1);
                //var lastdt = Math.floor(sjd[mc[mi + 1]] + 0.5) - Math.floor(sjd[mc[mi]] + 0.5);
                  // alert(mc[mi]);
               //alert(lastdt);
             //if(m==1 && (i+1)==term2) {
                //   Cy=GanZhi(y-1912+48);
                //   Czod=Zodiac[(y-1912+48)%12]; }
              //  Czod = Zodiac[(yi - 1912 + 48) % 12];
             var   jdstk = TWNSTR[(jdx + 12) % 28];
              var  jdsth = TFSTR(jdstk, di) ;                  
                //jdstr = FRLG(Syr, Smn, Sdn);
             var jdstrg = FRLG(yea,mx,pod+1);
                // jdstr = FRLG(yea, mx, pod + 1);
             var jdscd = Selctd(CMM,CDD);
             var jdsyk = YNK(mis, di);
             var jdsgd = FRGSD(CYY, CMM, CDD);
            // jdstr = jdscd +jdsgd+ jdsth + jdsyk + jdstrg;
             var mist = ((mis < 10) ? "0" : "") + mis;
             var dit = ((di < 10) ? "0" : "") + di;
              lHliday = LHDAY(mist, dit, lastdLM,IL);
            // var lstdLM = LHDAY(mist, dit, lastdt);
             //以月來調整年,因mc(mi)=0對應到前一年陰曆11月，mc(mi)=1對應到前一年陰曆12月，mc(mi)=2對應到本年1月，依此類推
            //  var lHlidayt = (mc[mi] + ":" + (sjd[mc[mi]] - sjd[mc[mi - 1]]));
                 //alert(mi +":" + (sjd[mi] - sjd[mi-1]));
             jdstr = jdscd + jdsgd + jdsth + jdsyk + jdstrg + lHliday +lastdLM;
             //this[kk] = new calElement(yea, mx, pod, dStr1[wk], yi, mis, di, IL, CY, CM, CD, Czod);
                this[kk] = new calElement(yea, mx, pod,dStr1[wk], yi, mis, di, IL, CYY, CMM, CDD, Czod,jdstr,lHliday);
                // document.write(XX this[kk] + "</br>");
               
         }
         
         // alert(jdstrg);
        // alert( lHliday);
         // document.write("hellow");
         //tmp1=sTermjieqi(y,m*2  )-1;
        // tmp2=sTerm(y,m*2+1)-1;
        // var tmp12=jieqi(y,(m-1)*2)-1;
        // var tmp22=jieqi(y,(m-1)*2+1)-1;
         var tmp12 = jieqi(y, (m - 1) * 2) ;
         var tmp22 = jieqi(y, (m - 1) * 2 + 1);
        tmp1 = parseInt(tmp12.substring(8,10))-1;
        tmp2 = parseInt(tmp22.substring(8,10))-1;
       // alert(tmp12);
       // alert(tmp12.substring(5,10));
       // alert(tmp1);
         //  tmp1=jieqi(y,(m-1)*2)-1;
          //  tmp2=jieqi(y,(m-1)*2+1)-1;
           this[tmp1].solarTerms = SolarTerm[(m-1)*2];
           this[tmp2].solarTerms = SolarTerm[(m-1)*2+1];
           if(m ==2) this[tmp1].color = 'red';
         //  alert( this[tmp2].solarTerms );
            for(i in NHoliday)
                if(NHoliday[i].match(/^(\d{2})(\d{2})([\s\*])(.+)$/))
                    if(Number(RegExp.$1)==(m)) {
                        if(Number(RegExp.$2)<=this.length){
                            this[Number(RegExp.$2)-1].Nholiday += RegExp.$4 + ' ';
                            if(RegExp.$3=='*') this[Number(RegExp.$2)-1].color = 'red';
                        }
                    }
            for(i in WHoliday)
                if(WHoliday[i].match(/^(\d{2})(\d)(\d)([\s\*])(.+)$/))
                    if(Number(RegExp.$1)==(m)) {
                        tmp1=Number(RegExp.$2);
                        tmp2=Number(RegExp.$3);
                        if(tmp1<5)
                            this[((this.firstWeek>tmp2)?7:0) + 7*(tmp1-1) + tmp2 - this.firstWeek].Nholiday += RegExp.$5 + ' ';
                        else {
                            tmp1 -= 5;
                            tmp3 = (this.firstWeek+this.length-1)%7;
                            this[this.length - tmp3 - 7*tmp1 + tmp2 - (tmp2>tmp3?7:0) - 1 ].Nholiday += RegExp.$5 + ' ';
                        }
                    }
         //   for(i in LHoliday)
         //       if(LHoliday[i].match(/^(\d{2})(.{2})([\s\*])(.+)$/)) {
          //        tmp1=Number(RegExp.$1)-firstLM;
          //         if(tmp1==-11) tmp1=1;
          //         //if (tmp1 >= 0 && tmp1 <?= n) {
                    // if (tmp1 >= 0 && tmp1 < n) {
           //        if (tmp1 == 0) {
            //           tmp2 = Ldpos[tmp1] + Number(RegExp.$2) -1;
            //            if( tmp2 >= 0 && tmp2<this.length && this[tmp2].isLeap!=true) {
             //              this[tmp2].Lholiday += RegExp.$4 + ' ';
              //              if(RegExp.$3=='*') this[tmp2].color = 'red';
           //             }
           //        }
         //    }

           // if(m==2 || m==3) {
               // var estDay = new easter(y);
              //  if(m == estDay.m)
               //     this[estDay.d-1].Nholiday = this[estDay.d-1].Nholiday+'復活節';
           // }
            //if((this.firstWeek+12)%7==5) this[12].Nholiday += '黑色星期五';
            if(y==Ny && m==Nm) {
                //this[Nd - 1].isToday = true;
                this[Nd].isToday = true;
                this[Nd].color ='#ff00ff';
            }
     }

    ////////////////////////////////////////////////////////////
    ////var LHoliday = new Array(
    // "0101*春節","0102*回娘家","0103*祭祖","0104 迎神","0105 開市","0109 天公生","0115 元宵節","0202 頭牙",
    // "0323 媽祖生","0408 浴佛節","0505*端午節","0701 開鬼門","0707 七夕情人節","0715 中元節","0800(0729) 關鬼門",
    // "0815*中秋節","0909 重陽節","1208 臘八節","1216 尾牙","1224 送神","0100(1229)*除夕");

     function  LHDAY(lnm,lnd,lastd,isLp) {
         var LHlidA = new Array("01/01","01/02","01/03","01/04","01/05","01/09","01/15","02/02","03/23","04/08","05/05","07/01","07/07","07/15","08/00","08/15","09/09","12/08","12/16","12/24","01/00");
         var LHlidT = new Array("春節","回娘家","祭祖","迎神","開市","天公生","元宵節"," 頭牙","媽祖生","浴佛節","端午節","開鬼門","七夕情人節","中元節","關鬼門","中秋節","重陽節"," 臘八節","尾牙","送神","除夕"); 
         // tmp1 = Number(RegExp.$1);
         //  tmp3 = Number(RegExp.$2);  //(this[tmp2].isLeap!=true)
         var i;
         var rtna, rtn,lnmd;
         if (lnm == 7) {
             if ((lastd == 29 && lnd == 29) || (lastd == 30 && lnd == 30)) { lnm = "08"; lnd = "00"; }
                }
         if (lnm == 12) {
             if ((lastd == 29 && lnd == 29) || (lastd == 30 && lnd == 30)) { lnm = "01"; lnd = "00"; }
         }
             
        lnmd = (lnm + "/" + lnd);
         for (i = 0; i <= 20; i++) {
             //if ((lnm + "/" + lnd) == LHlidA[i]) {
             if ((lnmd) == LHlidA[i] && isLp != true) {
                 //'' If CDate(lnmd) =CDate(YNKA(i)) { small literal  %->+ // Then
                 rtna = LHlidT[i];
                 break;// Exit For
             }
             else {
                 rtna = " ";
             }  //  End If
         }
            return rtna;
           //  alert(lnmd);
        //return lnmd;
     }
    ///////////////////////////////////////////////////////////////
     function FRGSD(lcy, lcm, lcd) {
         var kn, slkn ;  //As Integer
     // var lcy1, lcy2, lcm1, lcm2, lcd1, lcd2
         var i1, i2, i3, i4, i5, i6, i7, i8, i9, i10, i11, i12 ; //As Integer
        var rtntt , rtn1, rtn2, rtn3, rtn4, rtn5, rtn6, rtn7, rtn8, rtn9, rtn10, rtn11, rtn12;
        // var lcy1 = Left(lcy, 1);
        // var lcy2 = Right(lcy, 1);
         var lcy1 = lcy.substr(0,1);
         var lcy2 = lcy.substr(1,2);
         var lcm1 = lcm.substr(0,1);
         var lcm2 = lcm.substr(1,2);
         var lcd1 = lcd.substr(0,1);
         var lcd2 = lcd.substr(1,2);
         // On Error Resume Next
     //    for ( kn = 1;kn <= 12;kn++){
      //       slkn = kn;
             // Select Case slkn;
    //    switch (slkn) {
     //            case 1 :    //year-tnk,  date-tnk   = new Array(
     var Yerd= new Array("甲甲", "乙庚", "丙丙", "丁壬", "戊戊", "己甲", "庚庚", "辛丙", "壬壬", "癸戊");
         for ( i1 = 0 ;i1 <= 9;i1++){
    if ((lcy1 + lcd1) == Yerd[i1]) {    //Then
     // If CDate(lnmd) =CDate(YNKA(i)) Then
        rtn1 = "歲德日";
     break ;   //Exit For
    }  else {
        rtn1 = "";
     }  //  End If
    }  //  Next
     //  Return rtn1    // Return (CDate(YNKA(7)))  //note Exit-for
  //    break;    case 2 :
     var Yerdh= new Array("甲己", "乙乙", "丙辛", "丁丁", "戊癸", "己己", "庚乙", "辛辛", "壬丁", "癸癸");
     for ( i2 = 0 ; i2 <= 9;i2++){
     if ((lcy1 + lcd1) == Yerdh[i2]) {    //Then
         rtn2 = "歲德合日";
     break ;   //Exit For
     }  else {
         rtn2 = "";
     }  //  End If
     }  //  Next
         // Return rtn2     // Return (CDate(YNKA(7)))  //note Exit-for
 //  break;    case 3 :    ////month-deg,  date-tnk
     var Tend= new Array("子巽", "丑庚", "寅丁", "卯坤", "辰壬", "巳辛", "午乾", "未甲", "申癸", "酉艮", "戌丙", "亥乙");
     for ( i3 = 0 ;i3 <= 11;i3++){
    if ((lcm2 + lcd1) == Tend[i3]) {    //Then
        rtn3 = "天德日";
     break ;   //Exit For
     }  else {
        rtn3 = "";
     }  //  End If
     }  //  Next
         // Return rtn1  // Return (CDate(YNKA(7)))  //note Exit-for
  //  break;    case 4 :
     var Tendh= new Array("子", "丑乙", "寅壬", "卯", "辰丁", "巳丙", "午", "未己", "申戊", "酉", "戌辛", "亥庚");
     for ( i4 = 0 ;i4 <= 11;i4++){
    if ((lcm2 + lcd1) == Tendh[i4]) {    //Then
        rtn4 = "天德合日";
     break ;   //Exit For
     }  else {
        rtn4 = "";
     }  //  End If
     }  //  Next
         // Return rtn4   // Return (CDate(YNKA(7)))  //note Exit-for
  // break;    case 5 :     //'month-deg,  date-tnk
     var Mend= new Array("子壬", "丑庚", "寅丙", "卯甲", "辰壬", "巳庚", "午丙", "未甲", "申壬", "酉庚", "戌丙", "亥甲");
     for ( i5 = 0 ;i5 <= 11;i5++){
    if ((lcm2 +lcd1) == Mend[i5]) {    //Then
         // If CDate(lnmd) =CDate(YNKA(i)) Then
        rtn5 = "月德日";
     break ;   //Exit For
     }  else {
        rtn5 = "";
     }  //  End If
     }  //  Next
         //  Return rtn5    // Return (CDate(YNKA(7)))  //note Exit-for
  // break;    case 6 :
     var Mendh= new Array("子丁", "丑乙", "寅辛", "卯己", "辰丁", "巳乙", "午辛", "未己", "申丁", "酉乙", "戌辛", "亥己");
     for ( i6 = 0 ;i6 <= 11;i6++){
    if ((lcm2+ lcd1) == Mendh[i6]) {    //Then
         // If CDate(lnmd) =CDate(YNKA(i)) Then
        rtn6 = "月德合日";
     break ;   //Exit For
     }  else {
        rtn6 = "";
     }  //  Endif
     }  //  Next
         //  Return rtn6  // Return (CDate(YNKA(7)))  //note Exit-for
  //  break;    case 7 :        //'month-deg,  date-tnk-deg
     var Tense= new Array("亥甲子", "子甲子", "丑甲子", "寅戊寅", "卯戊寅", "辰戊寅", "巳甲午", "午甲午", "未甲午", "申戊申", "酉戊申", "戌戊申");
     for ( i7 = 0 ;i7 <= 11;i7++){
    if ((lcm2 + lcd) == Tense[i7]) {    //Then
         // If CDate(lnmd) =CDate(YNKA(i)) Then
        rtn7 = "天赦日";
     break ;   //Exit For
     }  else {
        rtn7 = "";
     }  //  End If
     }  //  Next
         //  Return rtn6  // Return (CDate(YNKA(7)))  //note Exit-for
                  
 // break;    case 8 :        //'  date-tnk-deg
     var Tenne = new Array("甲子", "乙丑", "丙寅", "丁卯", "戊辰", "己卯", "庚辰", "辛巳", "壬午", "癸未", "己酉", "庚戌", "辛亥", "壬子", "癸丑");
     for ( i8 = 0 ;i8 <= 14;i8++){
    if (lcd == Tenne[i8]) {    //Then
         // If CDate(lnmd) =CDate(YNKA(i)) Then
        rtn8 = "天恩日";
     break ;   //Exit For
     }  else {
        rtn8 = "";
     }  //  End If
     }  //  Next
         //  Return rtn6  // Return (CDate(YNKA(7)))  //note Exit-for
                   
  // break;    case 9 :         //'month-deg,  date-deg
     var Kfdr= new Array("亥申", "子申", "丑申", "寅亥", "卯亥", "辰亥", "巳寅", "午寅", "未寅", "申巳", "酉巳", "戌巳", "亥酉", "子酉", "丑酉", "寅子", "卯子", "辰子", "巳卯", "午卯", "未卯", "申午", "酉午", "戌午");
     for ( i9 = 0 ;i9 <= 23;i9++){
    if ((lcm2+lcd2) == Kfdr[i9]) {    //Then
         // If CDate(lnmd) =CDate(YNKA(i)) Then
        rtn9 = "刀占日";
    break ;   //Exit For
     }  else {
        rtn9 = "";
     }  //  Endif
     }  //  Next
         //  Return rtn6  // Return (CDate(YNKA(7)))  //note Exit-for
                  
  //   break;    case 10:          //month-deg,  date-deg
     var Bkdr = new Array("子午", "丑未", "寅申", "卯酉", "辰戌", "巳亥", "午子", "未丑", "申寅", "酉卯", "戌辰", "亥巳");
     for ( i10 = 0 ;i10 <= 11;i10++){
    if ((lcm2 + lcd2) == Bkdr[i10]) {    //Then
         // If CDate(lnmd) =CDate(YNKA(i)) Then
        rtn10 = "沖破日";
         break ;   //Exit For
     }  else {
        rtn10 = "";
        }  //  End If
     }  //  Next
         //  Return rtn6  // Return (CDate(YNKA(7)))  //note Exit-for
                   
  //   break;   case 11:      
    // break;     case 12:
      
  //   } //End Select
    //     }  //  Next
         //month-deg,  date-deg
     var Sodr = new Array("子卯", "丑酉", "寅戌", "卯辰", "辰亥", "巳巳", "午子", "未午", "申丑", "酉未", "戌寅", "亥申");
     for (i11 = 0 ; i11 <= 11; i11++) {
         if ((lcm2 + lcd2) == Sodr[i11]) {    //Then
             // If CDate(lnmd) =CDate(YNKA(i)) Then
             rtn11 = "受困日";
            break; //Exit For
         } else {
             rtn11 = "";
         }  //  End If
     }  //  Next
         //  Return rtn6  // Return (CDate(YNKA(7)))  //note Exit-for 

         //month-deg,  date-deg
         var Redr = new Array("子巳", "丑丑", "寅酉", "卯巳", "辰丑", "巳酉", "午巳", "未丑", "申酉", "酉巳", "戌丑", "亥酉");
         for (i12 = 0 ; i12 <= 11; i12++) {
             if ((lcm2 + lcd2) == Redr[i12]) {    //Then
                 // If CDate(lnmd) =CDate(YNKA(i)) Then
                 rtn12 = "紅紗日";
                  break ; //Exit For
             }
             else {
                 rtn12 = "";
             }  //  End If
         }  //  Next
         //  Return rtn6  // Return (CDate(YNKA(7)))  //note Exit-for
         rtntt = rtn1 + rtn2 + rtn3 + rtn4 + rtn5 + rtn6 + rtn7 + rtn8 + rtn9 + rtn10 + rtn11 + rtn12;
      return rtntt ;   // Return (CDate(YNKA(7)))  //note Exit-for
         // return lcm2 + lcd2+rtn12;
     } //End Function


         ///////////////////////////////////////////////////////////////
     function YNK(lnm, lnd) {
       var YNKA = new Array("0/0", "1/13", "2/11", "3/9", "4/7", "5/5", "6/3", "7/1", "7/29", "8/27", "9/25", "10/23", "11/21", "12/19");
       var rtn, rtna, lnmd;
       var i;
         //''On Error Resume Next
       lnmd = (lnm + "/" + lnd);
      for( i = 1;i<= 13;i++) {
          if ((lnm + "/" + lnd) == YNKA[i]) {
         //'' If CDate(lnmd) =CDate(YNKA(i)) { small literal  %->+ // Then
              rtna = "楊公忌";
              break;// Exit For
     }
     else   {
              rtna = "";
     } //End If
     }  //Next
         //''rtn = rtna + rtnb
     return rtna;
         ///'' Return (CDate(YNKA(7)))  ''note Exit-for
     } // End Function
    
     function Selctd(cmg, cdg) {
         var RBD = new Array( "建日", "除日", "满日", "平日", "定日", "执日", "破日", "危日", "成日", "收日", "开日", "闭日");
         var KTK = new Array("癸", "甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸");
         var KDG = new Array("亥", "子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥");
        
         var cmgd, cdgd  ;
         // cmgd = Right(cmg, 1)
         //cdgd = Right(cdg, 1)
        cdgd =cdg.substr(1,2);
       cmgd = cmg.substr(1, 2);
        var i, j, k;
        var rtna, Rowk;
         //var SLKD(12, 12);
        var SLKD = new Array(12);
        for (k =0;k<=12;k++) {
            SLKD[k] = new Array(12);
     }
         // On Error Resume Next
         //''For i = 1 To 6
         // For i = 1 To 12
         // For j = 1 To 12
        for (i =1;i<=12;i++) {
            for (j =1;j<=12;j++) {
         // '' SLKD(i, j) = KDG(i) & KDG((i + j + 1) Mod 12)
         //'' SLKD(i, j + 6) = KDG(i) & KDG((i + j + 7) Mod 12)
                SLKD[i][j] = KDG[i]+ KDG[j];
             
                if ((cmgd + cdgd) == SLKD[i][j]) {
                    rtna = RBD[(12 + j - i) % 12] ;
                    break; //  Exit For
         //  ''Else
         // ''  rtna = "NOa "
     }    //  End If
     }           //  Next
     }          //Next
         //return (cmgd + cdgd);
        return rtna;
         // '' Response.Write (Rowk)
         //''spnTerm=Rowk
     }  // End Function


         ///////////////////////////////////////////////////////////////////////////
         function TFSTR(jdstk, di) {
             var TWNSTR = new Array("轸", "角", "亢", "氐", "房", "心", "尾", "箕", "斗", "牛", "女", "虛", "危", "室", "壁", "奎", "娄", "胃", "昴", "毕", "觜", "参", "井", "鬼", "柳", "星", "张", "翼", "轸");
             var Rmla = new Array("角1", "虛8", "牛15", "亢15", "虛23", "娄30", "鬼29");
             var i;
             var rtnb, rtn;
             ///On Error Resume Next
             ///     var TOETT = TOETA((DDtD3 + 19) Mod 28)
             ///  Response.Write("二八星宿:" & TOETT & "<br>")
             /// var toett = TWNSTR[(jdx + 12) % 28];
             for (i = 0 ; i <= 6 ; i++) {
                 if ((jdstk + di) == Rmla[i]) {
                     //'' If CDate(lnmd) =CDate(YNKA(i)) Then
                     rtnb = "真滅沒";
                     break;
                     ///''Exit For;
                 }
                 else {
                     rtnb = "";
                 }
             }
             rtn = jdstk +"星"+ rtnb;
             return rtn;
             //  return (jdstk + di).substr(0,3)+rtnb;
             //return ((jdstk + di).substr(0, 3) == Rmla[4].substr(0, 3));
         }
    ////////////////////////////////////////////////////////////////////////////////
     function FRLG(yea, mx, podd) {
         //'' var FRLGA() = {spnTermd(Syrn - 1, 24), spnTermd(Syrn, 3), spnTermd(Syrn, 6), spnTermd(Syrn, 9), spnTermd(Syrn, 12), _
         // ''     spnTermd(Syrn, 15), spnTermd(Syrn, 18), spnTermd(Syrn, 21), spnTermd(Syrn, 24)}
         var  FRLGA = new Array(8);
         var j, i ;
         var rtn ,Symd;
         var mt = ((mx < 10) ? "0" : "") + mx;
         var dt = ((podd < 10) ? "0" : "") + podd;
         Symd = yea + "/" + mt + "/" + (dt +1);
         //''lnmd = Trim(lnm & "/" & lnd)
         // On Error Resume Next
         // FRLGA[0] = spnTermd(yea - 1, 24)    ///''''前冬至日''
          FRLGA[0] = jieqi(yea - 1, 24-1) ;    ///''''前冬至日''
         // ' FRLGA(1) = spnTermd(Syr, 3)
         for (j = 1 ;j<=8 ;j++){
             FRLGA[j] = jieqi(yea , j*3-1) ;  //spnTermd(Syr, J * 3)  //jieqi(y, (m - 1) * 2) ;
             // '' terms = spnTerm(y, 12)  '''''''今夏至日'''
             // ''  termw1 = spnTerm(y - 1, 24)  ''''前冬至日'''
             // '''前冬至日'''(-24 ,3,6,9,12,15,18,21,24)-1
             // '' termw2 = spnTerm(y, 24)  ''''''今冬至日''''
         }
      //   alert(yea);
        for (i = 0 ;i<=8 ;i++){
             if ((Symd.substr(0,10)) == (FRLGA[i].substr(0,10))) {
             // '' If CDate(lnmd) =CDate(YNKA(i)) Then  Else (Must small literal)
             rtn = "四離絕忌" ;
            break ;     ///// Exit For
           }
         else {
             rtn = "" ;
          }
       }
         // return FRLGA[1];
         //return (Symd.substr(0, 10) + rtn + FRLGA[0].substr(0, 10));
        return (rtn);
         
      }  
   ////////////////////////////////////////////////////////////
  function ValidDate(op, yy, mm, dd) {//驗證日期是否有效
      var vd = true;
      if (mm <= 0 || mm > 12) {
          alert("月份超出範圍");
          vd = false;
      }
      else {
          var ndf1 = -(yy % 4 == 0);	//可被四整除
          var ndf2 = ((yy % 400 == 0) - (yy % 100 == 0)) && (((yy > 1582) && (!op)) || op);
          var ndf = ndf1 + ndf2;
          var dom = 30 + ((Math.abs(mm - 7.5) + 0.5) % 2) - (mm == 2) * (2 + ndf);
          if (dd <= 0 || dd > dom) {
              if (ndf == 0 && mm == 2 && dd == 29) {
                  alert("此年無閏月");
              }
              else {
                  alert("日期超出範圍");
              }
              vd = false;
          }
      }
      if ((yy == 1582 && mm == 10 && dd >= 5 && dd < 15) && !op) {
          alert("此日期不存在");
          vd = false;
      }
      return vd;
}

  function VE(yy) {//计算指定年的春分点
      var yx = yy;
      if (yx >= 1000 && yx <= 8001) {
          var m = (yx - 2000) / 1000;
          jdve = 2451623.80984 + 365242.37404 * m + 0.05169 * m * m - 0.00411 * m * m * m - 0.00057 * m * m * m * m;
      }
      else {
          if (yx >= -8000 && yx < 1000) {
              m = yx / 1000;
              jdve = 1721139.29189 + 365242.1374 * m + 0.06134 * m * m + 0.00111 * m * m * m - 0.00071 * m * m * m * m;
          }
          else {
              alter("超出计算能力范围");
              return false;
          }
      }
      return jdve
  }

  function MeanJQJD(yy, jdve, ty, ini, num) {
      var ath = 2 * Math.PI / 24;
      var tx = (jdve - 2451545) / 365250;
      var e = 0.0167086342 - 0.0004203654 * tx - 0.0000126734 * tx * tx + 0.0000001444 * tx * tx * tx - 0.0000000002 * tx * tx * tx * tx + 0.0000000003 * tx * tx * tx * tx * tx;
      var tt = yy / 1000;
      var vp = 111.25586939 - 17.0119934518333 * tt - 0.044091890166673 * tt * tt - 4.37356166661345E-04 * tt * tt * tt + 8.16716666602386E-06 * tt * tt * tt * tt;
      var rvp = vp * 2 * Math.PI / 360;
      var peri = new Array(30);
      var i;
      for (i = 1; i <= (ini + num) ; i++) {
          var flag = 0;
          var th = ath * (i - 1) + rvp;
          if (th > Math.PI && th <= 3 * Math.PI) {
              th = 2 * Math.PI - th;
              flag = 1;
          }
          if (th > 3 * Math.PI) {
              th = 4 * Math.PI - th;
              flag = 2;
          }
          var f1 = 2 * Math.atan((Math.sqrt((1 - e) / (1 + e)) * Math.tan(th / 2)));
          var f2 = (e * Math.sqrt(1 - e * e) * Math.sin(th)) / (1 + e * Math.cos(th));
          var f = (f1 - f2) * ty / 2 / Math.PI;
          if (flag == 1) f = ty - f;
          if (flag == 2) f = 2 * ty - f;
          peri[i] = f;
      }
      for (i = ini; i <= (ini + num) ; i++) {
          jdez[i] = jdve + peri[i] - peri[1];
      }
      return true;
}

  function Perturbation(jdez) {
      var t = (jdez - 2451545) / 36525;
      var s = 0;
      for (k = 0; k <= 23; k++) {
          s = s + ptsa[k] * Math.cos(ptsb[k] * 2 * Math.PI / 360 + ptsc[k] * 2 * Math.PI / 360 * t);
      }
      var w = 35999.373 * t - 2.47;
      var l = 1 + 0.0334 * Math.cos(w * 2 * Math.PI / 360) + 0.0007 * Math.cos(2 * w * 2 * Math.PI / 360);
      var ptb = 0.00001 * s / l;
      return ptb;
}

  function DeltaT(yy, mm) {
      var u, t, dt, y;
      y = yy + (mm - 0.5) / 12;

      if (y <= -500) {
          u = (y - 1820) / 100;
          dt = (-20 + 32 * u * u);
      }
      else {
          if (y < 500) {
              u = y / 100;
              dt = (10583.6 - 1014.41 * u + 33.78311 * u * u - 5.952053 * u * u * u - 0.1798452 * u * u * u * u + 0.022174192 * u * u * u * u * u + 0.0090316521 * u * u * u * u * u * u);
          }
          else {
              if (y < 1600) {
                  u = (y - 1000) / 100;
                  dt = (1574.2 - 556.01 * u + 71.23472 * u * u + 0.319781 * u * u * u - 0.8503463 * u * u * u * u - 0.005050998 * u * u * u * u * u + 0.0083572073 * u * u * u * u * u * u);
              }
              else {
                  if (y < 1700) {
                      t = y - 1600;
                      dt = (120 - 0.9808 * t - 0.01532 * t * t + t * t * t / 7129);
                  }
                  else {
                      if (y < 1800) {
                          t = y - 1700;
                          dt = (8.83 + 0.1603 * t - 0.0059285 * t * t + 0.00013336 * t * t * t - t * t * t * t / 1174000);
                      }
                      else {
                          if (y < 1860) {
                              t = y - 1800;
                              dt = (13.72 - 0.332447 * t + 0.0068612 * t * t + 0.0041116 * t * t * t - 0.00037436 * t * t * t * t + 0.0000121272 * t * t * t * t * t - 0.0000001699 * t * t * t * t * t * t + 0.000000000875 * t * t * t * t * t * t * t);
                          }
                          else {
                              if (y < 1900) {
                                  t = y - 1860;
                                  dt = (7.62 + 0.5737 * t - 0.251754 * t * t + 0.01680668 * t * t * t - 0.0004473624 * t * t * t * t + t * t * t * t * t / 233174);
                              }
                              else {
                                  if (y < 1920) {
                                      t = y - 1900;
                                      dt = (-2.79 + 1.494119 * t - 0.0598939 * t * t + 0.0061966 * t * t * t - 0.000197 * t * t * t * t);
                                  }
                                  else {
                                      if (y < 1941) {
                                          t = y - 1920;
                                          dt = (21.2 + 0.84493 * t - 0.0761 * t * t + 0.0020936 * t * t * t);
                                      }
                                      else {
                                          if (y < 1961) {
                                              t = y - 1950;
                                              dt = (29.07 + 0.407 * t - t * t / 233 + t * t * t / 2547);
                                          }
                                          else {
                                              if (y < 1986) {
                                                  t = y - 1975;
                                                  dt = (45.45 + 1.067 * t - t * t / 260 - t * t * t / 718);
                                              }
                                              else {
                                                  if (y < 2005) {
                                                      t = y - 2000;
                                                      dt = (63.86 + 0.3345 * t - 0.060374 * t * t + 0.0017275 * t * t * t + 0.000651814 * t * t * t * t + 0.00002373599 * t * t * t * t * t);
                                                  }
                                                  else {
                                                      if (y < 2050) {
                                                          t = y - 2000;
                                                          dt = (62.92 + 0.32217 * t + 0.005589 * t * t);
                                                      }
                                                      else {
                                                          if (y < 2150) {
                                                              u = (y - 1820) / 100;
                                                              dt = (-20 + 32 * u * u - 0.5628 * (2150 - y));
                                                          }
                                                          else {
                                                              u = (y - 1820) / 100;
                                                              dt = (-20 + 32 * u * u);
                                                          }
                                                      }
                                                  }
                                              }
                                          }
                                      }
                                  }
                              }
                          }
                      }
                  }
              }
          }
      }

      if (y < 1955 || y >= 2005) dt = dt - (0.000012932 * (y - 1955) * (y - 1955));
      var DeltaT = dt / 60;    //將秒轉換為分
      return DeltaT
   }
  function Jdays(op, yr, mh, dy, hr) {//將年月日時，轉换爲儒略日
      if (yr < -400000 || yr > 400000) return false;
      var yp = yr + Math.floor((mh - 3) / 10);
      if (((yr > 1582) || (yr == 1582 && mh > 10) || (yr == 1582 && mh == 10 && dy >= 15)) || op) {
          var init = 1721119.5;
          var jdy = Math.floor(yp * 365.25) - Math.floor(yp / 100) + Math.floor(yp / 400);
      }
      else {
          if ((yr < 1582) || (yr == 1582 && mh < 10) || (yr == 1582 && mh == 10 && dy <= 4)) {
              var init = 1721117.5;
              var jdy = Math.floor(yp * 365.25);
          }
          else { return false; }
      }
      var mp = Math.floor(mh + 9) % 12;
      var jdm = mp * 30 + Math.floor((mp + 1) * 34 / 57);
      var jdd = dy - 1;
      var jdh = hr / 24;
      var jd = jdy + jdm + jdd + jdh + init;
      return jd;
}

//副程式功能：對Perturbaton作調整後的自春分點開始的24節氣,可只取部份
  function GetAdjustedJQ(yy, ini, num, jdjq) {
      var veb = VE(yy);
      var ty = VE(yy + 1) - veb;     //求指定年的春分點及回歸年長
      if (MeanJQJD(yy, veb, ty, ini, num) == true) {	//輸入指定年,JD,回歸年長,求該回歸年各節氣之長
          for (i = ini + 1; i <= (ini + num) ; i++) {
              ptb = Perturbation(jdez[i]);	//取得受perturbation影響所需微調
              dt = DeltaT(yy, Math.floor(i / 2) + 3);	//修正dynamical time to Universal time
              jdjq[i] = jdez[i] + ptb - dt / 60 / 24;	//加上攝動調整值ptb，減去對應的Delta T值(分鐘轉換為日)
              jdjq[i] = jdjq[i] + 1 / 3;	//因中國時間比格林威治時間先行8小時，即1/3日
          }
      }

}

//副程式功能：求出自冬至點為起點的連續16個中氣
  function GetZQsinceWinterSolstice(yy, jdzq) {
      //求出以冬至為起點之連續16個中氣（多取四個以備用）
      var dj = new Array(26);
      GetAdjustedJQ(yy - 1, 18, 5, dj);	//求出指定年冬至開始之節氣JD值,以前一年的值代入
      //轉移春分前之節氣至jdzq變數中，以重整index
      jdzq[0] = dj[19];                    //此為冬至中氣
      jdzq[1] = dj[21];                    //此為大寒中氣
      jdzq[2] = dj[23];                    //此為雨水中氣
      GetAdjustedJQ(yy, 0, 26, dj); //求出指定年節氣之JD值
      for (i = 1; i <= 13; i++) {
          jdzq[i + 2] = dj[2 * i - 1];     //轉移冬至後之節氣至jdzq變數中，以重整index
      }
}

//副程式功能：對於指定日期時刻所屬的朔望月，求出其均值新月點的月序數
  function MeanNewMoon(jd) {
      var t, thejd, jdt;
      //k為從2000年1月6日14時20分36秒起至指定年月日之陰曆月數,以synodic month為單位
      var k = Math.floor((jd - 2451550.09765) / synmonth); //2451550.09765為2000年1月6日14時20分36秒之JD值。
      jdt = 2451550.09765 + k * synmonth;
      //Time in Julian centuries from 2000 January 0.5.
      t = (jdt - 2451545) / 36525;  //以100年為單位,以2000年1月1日12時為0點
      thejd = jdt + 0.0001337 * t * t - 0.00000015 * t * t * t + 0.00000000073 * t * t * t * t;
      //2451550.09765為2000年1月6日14時20分36秒，此為2000年後的第一個均值新月
      return k;
}

//函式功能:求出實際新月點
//以2000年初的第一個均值新月點為0點求出的均值新月點和其朔望月之序數k
//代入此副程式來求算實際新月點
  function TrueNewMoon(k) {
      var t, t2, t3, t4;
      var m, mprime, f, omega, es;
      var pt, apt1, apt2, jdt;
      jdt = 2451550.09765 + k * synmonth;
      t = (jdt - 2451545) / 36525;	//2451545為2000年1月1日正午12時的JD
      t2 = t * t;      //square for frequent use
      t3 = t2 * t;     //cube for frequent use
      t4 = t3 * t;     //to the fourth
      //mean time of phase
      pt = jdt + 0.0001337 * t2 - 0.00000015 * t3 + 0.00000000073 * t4;
      //Sun's mean anomaly(地球繞太陽運行均值近點角)(從太陽觀察)
      m = 2.5534 + 29.10535669 * k - 0.0000218 * t2 - 0.00000011 * t3;
      //Moon's mean anomaly(月球繞地球運行均值近點角)(從地球觀察)
      mprime = 201.5643 + 385.81693528 * k + 0.0107438 * t2 + 0.00001239 * t3 - 0.000000058 * t4;
      //Moon's argument of latitude(月球的緯度參數)
      f = 160.7108 + 390.67050274 * k - 0.0016341 * t2 - 0.00000227 * t3 + 0.000000011 * t4;
      //Longitude of the ascending node of the lunar orbit(月球繞日運行軌道升交點之經度)
      omega = 124.7746 - 1.5637558 * k + 0.0020691 * t2 + 0.00000215 * t3;
      //乘式因子
      es = 1 - 0.002516 * t - 0.0000074 * t2;
      //因perturbation造成的偏移：
      apt1 = -0.4072 * Math.sin((Math.PI / 180) * mprime);
      apt1 += 0.17241 * es * Math.sin((Math.PI / 180) * m);
      apt1 += 0.01608 * Math.sin((Math.PI / 180) * 2 * mprime);
      apt1 += 0.01039 * Math.sin((Math.PI / 180) * 2 * f);
      apt1 += 0.00739 * es * Math.sin((Math.PI / 180) * (mprime - m));
      apt1 -= 0.00514 * es * Math.sin((Math.PI / 180) * (mprime + m));
      apt1 += 0.00208 * es * es * Math.sin((Math.PI / 180) * (2 * m));
      apt1 -= 0.00111 * Math.sin((Math.PI / 180) * (mprime - 2 * f));
      apt1 -= 0.00057 * Math.sin((Math.PI / 180) * (mprime + 2 * f));
      apt1 += 0.00056 * es * Math.sin((Math.PI / 180) * (2 * mprime + m));
      apt1 -= 0.00042 * Math.sin((Math.PI / 180) * 3 * mprime);
      apt1 += 0.00042 * es * Math.sin((Math.PI / 180) * (m + 2 * f));
      apt1 += 0.00038 * es * Math.sin((Math.PI / 180) * (m - 2 * f));
      apt1 -= 0.00024 * es * Math.sin((Math.PI / 180) * (2 * mprime - m));
      apt1 -= 0.00017 * Math.sin((Math.PI / 180) * omega);
      apt1 -= 0.00007 * Math.sin((Math.PI / 180) * (mprime + 2 * m));
      apt1 += 0.00004 * Math.sin((Math.PI / 180) * (2 * mprime - 2 * f));
      apt1 += 0.00004 * Math.sin((Math.PI / 180) * (3 * m));
      apt1 += 0.00003 * Math.sin((Math.PI / 180) * (mprime + m - 2 * f));
      apt1 += 0.00003 * Math.sin((Math.PI / 180) * (2 * mprime + 2 * f));
      apt1 -= 0.00003 * Math.sin((Math.PI / 180) * (mprime + m + 2 * f));
      apt1 += 0.00003 * Math.sin((Math.PI / 180) * (mprime - m + 2 * f));
      apt1 -= 0.00002 * Math.sin((Math.PI / 180) * (mprime - m - 2 * f));
      apt1 -= 0.00002 * Math.sin((Math.PI / 180) * (3 * mprime + m));
      apt1 += 0.00002 * Math.sin((Math.PI / 180) * (4 * mprime));

      apt2 = 0.000325 * Math.sin((Math.PI / 180) * (299.77 + 0.107408 * k - 0.009173 * t2));
      apt2 += 0.000165 * Math.sin((Math.PI / 180) * (251.88 + 0.016321 * k));
      apt2 += 0.000164 * Math.sin((Math.PI / 180) * (251.83 + 26.651886 * k));
      apt2 += 0.000126 * Math.sin((Math.PI / 180) * (349.42 + 36.412478 * k));
      apt2 += 0.00011 * Math.sin((Math.PI / 180) * (84.66 + 18.206239 * k));
      apt2 += 0.000062 * Math.sin((Math.PI / 180) * (141.74 + 53.303771 * k));
      apt2 += 0.00006 * Math.sin((Math.PI / 180) * (207.14 + 2.453732 * k));
      apt2 += 0.000056 * Math.sin((Math.PI / 180) * (154.84 + 7.30686 * k));
      apt2 += 0.000047 * Math.sin((Math.PI / 180) * (34.52 + 27.261239 * k));
      apt2 += 0.000042 * Math.sin((Math.PI / 180) * (207.19 + 0.121824 * k));
      apt2 += 0.00004 * Math.sin((Math.PI / 180) * (291.34 + 1.844379 * k));
      apt2 += 0.000037 * Math.sin((Math.PI / 180) * (161.72 + 24.198154 * k));
      apt2 += 0.000035 * Math.sin((Math.PI / 180) * (239.56 + 25.513099 * k));
      apt2 += 0.000023 * Math.sin((Math.PI / 180) * (331.55 + 3.592518 * k));
      var tnm = pt + apt1 + apt2;
      return tnm;
}

//副程式功能：求算以含冬至中氣為陰曆11月開始的連續16個朔望月
  function GetSMsinceWinterSolstice(op, yy, jdws, jdnm) {
      var kn, tjd = new Array, i, k, mjd, thejd;
      var spcjd, phase, kn;
      spcjd = Jdays(op, yy - 1, 11, 0, 0);        //求年初前兩個月附近的新月點(即前一年的11月初)
      kn = MeanNewMoon(spcjd);   //求得自2000年1月起第kn個平均朔望日及其JD值
      for (i = 0; i <= 19; i++) {                         //求出連續20個朔望月
          k = kn + i;
          mjd = thejd + synmonth * i;
          tjd[i] = TrueNewMoon(k) + 1 / 3;      //以k值代入求瞬時朔望日,因中國比格林威治先行8小時，加1/3天
          //下式為修正dynamical time to Universal time
          tjd[i] = tjd[i] - DeltaT(yy, i - 1) / 1440;   //1為1月，0為前一年12月，-1為前一年11月(當i=0時，i-1=-1，代表前一年11月)
      }
      for (j = 0; j <= 18; j++) {
          if (Math.floor(tjd[j] + 0.5) > Math.floor(jdws + 0.5)) { break; }	//已超過冬至中氣(比較日期法)
      }
      jj = j;                                  //取此時的索引值
      for (k = 0; k <= 15; k++) {
          jdnm[k] = tjd[jj - 1 + k];            //重排索引，使含冬至朔望月的索引為0
      }
}

//副程式功能：以比較日期法求算冬月及其餘各月名稱代碼，包含閏月，冬月為0，臘月為1，正月為2，餘類推。閏月多加0.5
  function GetZQandSMandLunarMonthCode(op, yy, jdzq, jdnm, mc) {
      var yz;
      GetZQsinceWinterSolstice(yy, jdzq);        //取得以前一年冬至為起點之連續17個中氣
      GetSMsinceWinterSolstice(op, yy, jdzq[0], jdnm);	//求出以含冬至中氣為陰曆11月(冬月)開始的連續16個朔望月的新月點
      yz = 0;      //設定旗標，0表示未遇到閏月，1表示已遇到閏月
      if (Math.floor(jdzq[12] + 0.5) >= Math.floor(jdnm[13] + 0.5)) {      //若第13個中氣jdzq(12)大於或等於第14個新月jdnm(13)
          for (i = 1; i <= 14; i++) {                                 //表示此兩個冬至之間的11個中氣要放到12個朔望月中，
              //至少有一個朔望月不含中氣，第一個不含中氣的月即為閏月
              //若陰曆臘月起始日大於冬至中氣日，且陰曆正月起始日小於或等於大寒中氣日，則此月為閏月，其餘同理
              if (Math.floor((jdnm[i] + 0.5) > Math.floor(jdzq[i - 1 - yz] + 0.5) && Math.floor(jdnm[i + 1] + 0.5) <= Math.floor(jdzq[i - yz] + 0.5))) {
                  mc[i] = i - 0.5;
                  yz = 1;      //標示遇到閏月
              } else {
                  mc[i] = i - yz;	//遇到閏月開始，每個月號要減1
              }
          }
      } else {        //否則表示兩個連續冬至之間只有11個整月，故無閏月
          for (i = 0; i <= 12; i++) {     //直接賦予這12個月月代碼
              mc[i] = i;
          }
          for (i = 13; i <= 14; i++) {        //處理次一置月年的11月與12月，亦有可能含閏月
              //若次一陰曆臘月起始日大於附近的冬至中氣日，且陰曆正月起始日小於或等於大寒中氣日，則此月為閏月，次一正月同理。
              if (Math.floor((jdnm[i] + 0.5) > Math.floor(jdzq[i - 1 - yz] + 0.5) && Math.floor(jdnm[i + 1] + 0.5) <= Math.floor(jdzq[i - yz] + 0.5))) {
                  mc[i] = i - 0.5;
                  yz = 1;      //標示遇到閏月
              } else {
                  mc[i] = i - yz;  //遇到閏月開始，每個月號要減1
              }
          }
      }

}

//副程式功能：求出以立春點開始的不含中氣之12節氣
  function GetPureJQsinceSpring(yy, ptsa, ptsb, ptsc, jdpjq) {
      var sjdjq = new Array;
      var yea = yy - 1;
      GetAdjustedJQ(yea, 21, 3, sjdjq);   //求出含指定年立春開始之3個節氣JD值,以前一年的年值代入
      //轉移春分前之立春至驚蟄之節氣至jdpjq變數中，以重整index
      jdpjq[0] = sjdjq[22];                     //此為立春
      jdpjq[1] = sjdjq[24];                     //此為驚蟄
      yea = yy;
      GetAdjustedJQ(yea, 0, 26, sjdjq);       //求出指定年節氣之JD值,從驚蟄開始，到雨水
      //轉移春分至小寒之節氣至jdpjq變數中，以重整index
      for (i = 1; i <= 13; i++) {
          jdpjq[i + 1] = sjdjq[2 * i];
      }
}

  function GetGZ(op, spcjd, yea, ptsa, ptsb, ptsc, tg, dz) {
      //比較求算節氣年ty,求出年干支
      var jr = new Array;
      ty = yea;
      var jdxt;
      jdxt = spcjd +0.5;  /////''' 恢復正午算起為整數日 )  ///''
      GetPureJQsinceSpring(yea, ptsa, ptsb, ptsc, jr);	//取得自立春開始的非中氣之24節氣
     // if (spcjd <  jr[0]) {	//jr[0]為立春，約在2月5日前後，(//指令中加0.5是為了改為從0時算起而不從正午算起恢復正午算起為整數日 )
     // if ((spcjd)  < Math.floor(jr[0])) {	//jr[0]為立春，約在2月5日前後，
      if (Math.floor(jdxt) < Math.floor(jr[0] + 0.5)){
      ty = yea - 1;            //若小於jr[0],則屬於前一個節氣年
          GetPureJQsinceSpring(ty, ptsa, ptsb, ptsc, jr);     //取得自立春(include =)開始的不含中氣之12節氣
      }

      ygz = ((ty + 4712 + 24) % 60 + 60) % 60;
      tg[0] = ygz % 10;         //年干
      dz[0] = ygz % 12;         //年支

      //比較求算節氣月,求出月干支
     // for (j = 0; j <= 13; j++) {
       //  if (jr[j] >= spcjd) { tm = j - 1; break; }		//已超過指定時刻，故應取前一個節氣
      //   if (Math.floor(jr[j]) >= spcjd+0.5) { tm = j - 1; break; }		//已超過指定時刻，故應取前一個節氣
        //  if ((XJtime(false, spcjdt)) <= (XJtime(false,jr[j]))) { tm = j - 1; break; }		//已超過(not include)指定時刻，故應取前一個節氣
      for (var i = 0; j <= 13; i++) {
      if ((Math.floor(jdxt) >= Math.floor(jr[i] + 0.5)) && (Math.floor(jdxt) < Math.floor(jr[i + 1] + 0.5))) { tm = i; break; }
    
      }

     //  alert(XJtime(false,jr[11]));
   //    alert(XJtime(false, spcjdt));
    //   alert(spcjd + 0.5);
    //   alert(Math.floor(spcjd));
     
     
      tmm = ((ty + 4712) * 12 + (tm) + 60) % 60;
      mgz = (tmm + 50) % 60;
      tg[1] = mgz % 10;        //月干
      dz[1] = mgz % 12;         //月支

      //計算日柱之干支
      //jda = Jdays(op, yea, tmon, tday, thehou) + 0.5;     //加0.5是將起始點從正午改為從0點開始。
      jda = spcjd + 0.5;
      thes = ((jda - Math.floor(jda)) * 86400) + 3600;    //將jd的小數部份化為秒，並加上起始點前移的一小時(3600秒)，取其整數值
      dayjd = Math.floor(jda) + thes / 86400;              //將秒數化為日數，加回到jd的整數部份
      dgz = (Math.floor(dayjd + 49) % 60 + 60) % 60;
      tg[2] = dgz % 10;    //日干
      dz[2] = dgz % 12;    //日支

      //計算時柱之干支
      dh = dayjd * 12;
      hgz = (Math.floor(dh + 48) % 60 + 60) % 60;
      tg[3] = hgz % 10;    //時干
      dz[3] = hgz % 12;    //時支


}
    
    //////////////////////////////////////////////////////////////////////////////////////////////
var SolarTerm = new Array("小寒","大寒","立春","雨水","驚蟄","春分","清明","穀雨","立夏","小滿","芒種","夏至","小暑","大暑","立秋","處暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至");
var dStr1 = new Array('日','一','二','三','四','五','六','七','八','九','十');
var dStr2 = new Array('初','十','廿','卅','卌');
function cDay(d){
 var s;
 switch (d) {
    case 10:
       s = '初十'; break;
    case 20:
       s = '二十'; break;
    case 30:
       s = '三十'; break;
    default :
       s = dStr2[Math.floor(d/10)];
       s += dStr1[d%10];
 }
 return(s);
}
var Zodiac=new Array("鼠","牛","虎","兔","龍","蛇","馬","羊","猴","雞","狗","豬");
function drawCld(SY,SM) {
 var i,sD,s,size,Lastday;
 cld = new calendar(SY,SM);
 Lastday=isLeapYear(SY,SM-1);
  if (Selday> Lastday) Selday= Lastday;
 for(i=0;i<42;i++) {
    nObj=eval('SD'+ i);
    lObj=eval('LD'+ i);
	zObj=eval('DZ'+ i);
    nObj.style.cursor = 'hand'
    nObj.className = '';
   sD = i - cld.firstWeek;
    if(sD>-1 && sD<cld.length) {
      nObj.innerHTML = sD+1;
    if(cld[sD].isToday) Selday=sD+1;
  if (Selday==(i-cld.firstWeek+1)){
       mCls();
     if(cld[sD].lYear>1911) yDisplay = '民國' + (((cld[sD].lYear-1911)==1)?'元':cld[sD].lYear-1911);
     Ldz.innerHTML = '　農曆:' + yDisplay + '年 ' + (cld[sD].isLeap ? '閏 ' : ' ') + cld[sD].lMonth + ' 月 ' + cld[sD].lDay + ' 日';
	 	//Ldzx.innerHTML='　歲次：' +cld[sD].cYear+'年 '+cld[sD].cMonth+'('+cld[sD].jMonth+')'+'月 '+cld[sD].cDay + '日 生肖屬：【'+Zodiac[(cld[sD].lYear-4)%12]+'】';
    //Ldzx.innerHTML='　歲次：' +cld[sD].cYear+'年 '+cld[sD].cMonth+'月 '+cld[sD].cDay + '日 生肖屬：【'+Zodiac[(cld[sD].lYear-4)%12]+'】';
     Ldzx.innerHTML='　歲次：' +cld[sD].cYear+'年 '+cld[sD].cMonth+'月 '+cld[sD].cDay + '日 生肖屬：【'+cld[sD].cZod+'】';
   if(cld[sD].sYear>1911) yDisplay = '民國' + (((cld[sD].sYear-1911)==1)?'元':cld[sD].sYear-1911);
	  Ndz.innerHTML='　國曆:'+yDisplay+'年 '+cld[sD].sMonth+' 月 '+cld[sD].sDay+' 日';
	  CHSND.innerHTML = '聖師言:' + SND[(cld[sD].sMonth - 1) * 9 + (cld[sD].sDay) % 8]+"</br>";
	  CHSGD.innerHTML = cld[sD].jdstr ;
	  nObj.className = 'MoveColor';
 	  } 
    nObj.style.color = cld[sD].color; 
     if(cld[sD].lDay==1) 
	  if (cld[sD].isLeap) 
	      //lObj.innerHTML = '<b>' + '閏' + cld[sD].lMonth + '月' + (leapDays(cld[sD].lYear) == 29 ? '小' : '大') + '</b>'
	      lObj.innerHTML = '<b>' + '閏' + cld[sD].lMonth + '月'+ '</b>'
	  else
        //lObj.innerHTML = '<b>'+ cld[sD].lMonth + '月' + (LmonthDays(cld[sD].lYear,cld[sD].lMonth)==29?'小':'大')+'</b>';
       lObj.innerHTML = '<b>'+ cld[sD].lMonth + '月' +'</b>';
      else 
       lObj.innerHTML = cDay(cld[sD].lDay);
	   zObj.innerHTML = cld[sD].cDay;   
      s=cld[sD].solarTerms;
     if(s.length>0) s = s.fontcolor('#cc00cc');
     //  s = cld[sD].Lholiday;
    // s = cld[sD].lHliday;
     ///  if(s.length>0) {
     ///   if(s.length>6) s = s.substr(0, 5);
     ///    s = s.fontcolor('red');
    /// }
     else {
      s=cld[sD].Nholiday;
       if(s.length>0) {
        size = (s.charCodeAt(0)>0 && s.charCodeAt(0)<128)?8:5;
         if(s.length>size+2) s = s.substr(0, size);
          s=(s=='黑色星期五')?s.fontcolor('black'):s.fontcolor('blue');
        }
    else {
    // s=cld[sD].solarTerms;
   // if(s.length>0) s = s.fontcolor('#cc00cc');
           //    s=cld[sD].Lholiday;
           s=cld[sD].lHliday;
      if(s.length>0) {
       if(s.length>6) s = s.substr(0, 5);
         s = s.fontcolor('red');
        }

     }
   }
    if(cld[sD].solarTerms=='清明') s = '清明節'.fontcolor('red');
     if(s.length>0) zObj.innerHTML = s;
    }
   else { 
    nObj.innerHTML = '';
    lObj.innerHTML = '';
	zObj.innerHTML = '';
    }
  }
}

function changeCld() {
 var y,m;
   y = CLD.SY.selectedIndex + 1912;
    //  y = CLD.SY.selectedIndex ;//CLD.SY.selectedIndexie =0,1,2,......
    //m = CLD.SM.selectedIndex ;
   m = CLD.SM.selectedIndex+1 ;
 drawCld(y,m);
}

function pushBtm(K) {
 switch (K){
   case 'YD' :
    if(CLD.SY.selectedIndex>0) CLD.SY.selectedIndex--;
     break;
   case 'YU' :
       //if (CLD.SY.selectedIndex < 159) CLD.SY.selectedIndex++;
       if (CLD.SY.selectedIndex < 1060) CLD.SY.selectedIndex++;
        break;
   case 'MD' :
    if(CLD.SM.selectedIndex>0) {
     CLD.SM.selectedIndex--;
    }
   else {
       CLD.SM.selectedIndex = 11;
     if(CLD.SY.selectedIndex>0) CLD.SY.selectedIndex--;
     }
     break;
   case 'MU' :
     if (CLD.SM.selectedIndex < 11) {
     CLD.SM.selectedIndex++;
     }
   else {
    CLD.SM.selectedIndex=0;
       if (CLD.SY.selectedIndex < 159) CLD.SY.selectedIndex++;
   }
    break;
     default :
          CLD.SY.selectedIndex = Ny - 1912;
          CLD.SM.selectedIndex = Nm;
          var Today = new Date();
          //var Ny = Today.getFullYear();
          //var Nm = Today.getMonth() + 1;
          var Nd = Today.getDate();
          var fweek = Today.getDay();
          Selday = Nd;
         // Selday = Nd - fweek + 1;
          //drawCld(Ny, Nm);
 }
  changeCld();
}

 //////////////////////////////////////

function mDown(v) {
 var s,ax;
 var nObj=eval('SD'+ v);
 var d=nObj.innerHTML-1;
 var  mObj=eval('SD'+ Selday);
  if(nObj.innerHTML!='') {
    mObj.className='';
	 mCls();
   if(cld[d].lYear>1911) yDisplay = '民國' + (((cld[d].lYear-1911)==1)?'元':cld[d].lYear-1911);
	 Ldz.innerHTML ='　農曆:'+yDisplay+'年 '+(cld[d].isLeap?'閏 ':' ')+cld[d].lMonth+' 月 '+cld[d].lDay+' 日';
	 //Ldzx.innerHTML='　歲次：' +cld[d].cYear+'年 '+cld[d].cMonth+'('+cld[d].jMonth+')'+'月 '+cld[d].cDay + '日 生肖屬：【'+Zodiac[(cld[d].lYear-4)%12]+'】';
   	 //Ldzx.innerHTML='　歲次：' +cld[d].cYear+'年 '+cld[d].cMonth+'月 '+cld[d].cDay + '日 生肖屬：【'+Zodiac[(cld[d].lYear-4)%12]+'】';
    Ldzx.innerHTML='　歲次：' +cld[d].cYear+'年 '+cld[d].cMonth+'月 '+cld[d].cDay + '日 生肖屬：【'+cld[d].cZod+'】';
    if(cld[d].sYear>1911) yDisplay = '民國' + (((cld[d].sYear-1911)==1)?'元':cld[d].sYear-1911);
	Ndz.innerHTML='　國曆:'+yDisplay+'年 '+cld[d].sMonth+' 月 '+cld[d].sDay+' 日';
	CHSND.innerHTML = '聖師言:' + SND[(cld[d].sMonth - 1) * 9 + (cld[d].sDay) % 8]+"</br>";
	CHSGD.innerHTML = cld[d].jdstr ;
	nObj.className = 'MoveColor';
    Selday=v-cld.firstWeek+1;
      // s = '　歲次：' + cld[d].cYear + '年 ' + cld[d].cMonth + '(' + cld[d].jMonth + ')' + '月 ' + cld[d].cDay + ' 日';
    s = '　歲次：' + cld[d].cYear + '年 ' + cld[d].cMonth + '月 ' + cld[d].cDay + ' 日';

       } 
       
     }  
 
function GetZhi(s){
   s = s.substr(1, 1);
  for(i=0;i<12;i++)
   if(s==Zhi[i]) return(i);
}	

function mCls() {
 for(i=0;i<42;i++) {
    mObj=eval('SD'+ i);
	 mObj.className='';
  }	 
 }  
//-->
//-->
 
 //var today=new Date();
 //yr=today.getFullYear();
 //document.getElementById("in1").value=yr;

var ptsa = new Array(485, 203, 199, 182, 156, 136, 77, 74, 70, 58, 52, 50, 45, 44, 29, 18, 17, 16, 14, 12, 12, 12, 9, 8)
var ptsb = new Array(324.96, 337.23, 342.08, 27.85, 73.14, 171.52, 222.54, 296.72, 243.58, 119.81, 297.17, 21.02, 247.54, 325.15, 60.93, 155.12, 288.79, 198.04, 199.76, 95.39, 287.11, 320.81, 227.73, 15.45)
var ptsc = new Array(1934.136, 32964.467, 20.186, 445267.112, 45036.886, 22518.443, 65928.934, 3034.906, 9037.513, 33718.147, 150.678, 2281.226, 29929.562, 31555.956, 4443.417, 67555.328, 4562.452, 62894.029, 31436.921, 14577.848, 31931.756, 34777.259, 1222.114, 16859.074)
var jq = new Array("春分", "清明", "穀雨", "立夏", "小滿", "芒種", "夏至", "小暑", "大暑", "立秋", "處暑", "白露", "秋分", "寒露", "霜降", "立冬", "小雪", "大雪", "冬至", "小寒", "大寒", "立春", "雨水", "驚蟄")
var jdez=new Array(30);
var jdjq=new Array(26);
 
function jieqi(inl ,k){
var i,ptb,dt;
var ini=0,num=26;
//var yr=in1.value-0;
var yr=inl-0;
if(yr<-7000 || yr>7000){
	alert("超出&#35745;算能力");
	return false;
}

if(yr<-1000 || yr>3000){
	alert("适用于西元-1000年至西元3000年，超出此范&#22260;&#35823;差&#36739;大");
}
	//var jd=VE(yr);
	//var ty=VE(yr+1)-jd;
var jdpjq=new Array, jqc;
var jtd=new Array ;
var jqcd=new Array ;
var out="";
XGetPureJQsinceSpring(yr,ptsa,ptsb,ptsc,jdpjq);
//for(i=0;i<12;i++){
	//jqc=jq[(2*i+21)%24]+":";
 for(i=0;i<24;i++){
	jqc=jq[(i+19)%24]+":";
	jt=XJtime(false,jdpjq[i]);
	out+=jqc+jt+"\r\n";
	jqcd[i]=jq[(i+19)%24]+":";
	jtd[i]=XJtime(false,jdpjq[i]);

} 
   //return out ;
   return jtd[k] ;
   //return jqcd[k]+jtd[k] ;
 //show1.innerText=out;	//for IE
 //show1.textContent=out;	//for mozilla
}

function XVE(yy){//&#35745;算指定年的春分&#28857;
var yx=yy;
if(yx>=1000 && yx<=8001){
	var m=(yx-2000)/1000;
	jdve=2451623.80984+365242.37404*m+0.05169*m*m-0.00411*m*m*m-0.00057*m*m*m*m;
}
else{
	if(yx>=-8000 && yx<1000){
		m=yx/1000;
		jdve=1721139.29189+365242.1374*m+0.06134*m*m+0.00111*m*m*m-0.00071*m*m*m*m;
	}
	else{
		alter("超出&#35745;算能力范&#22260;");
		return false;
	}
}
return jdve
}

function XMeanJQJD(yy,jdve,ty,ini,num){
var ath=2*Math.PI/24;
var tx=(jdve-2451545)/365250;
var e=0.0167086342-0.0004203654*tx-0.0000126734*tx*tx+0.0000001444*tx*tx*tx-0.0000000002*tx*tx*tx*tx+0.0000000003*tx*tx*tx*tx*tx;
var tt=yy/1000;
var vp=111.25586939-17.0119934518333*tt-0.044091890166673*tt*tt-4.37356166661345E-04*tt*tt*tt+8.16716666602386E-06*tt*tt*tt*tt;
var rvp=vp*2*Math.PI/360;
var peri = new Array(30);
var i;
for(i=1;i<=(ini+num);i++){
	var flag=0;
	var th=ath*(i-1)+rvp;
	if(th>Math.PI && th<=3*Math.PI){
		th=2*Math.PI-th;
		flag=1;
	}
	if(th>3*Math.PI){
		th=4*Math.PI-th;
		flag=2;
	}
	var f1=2*Math.atan((Math.sqrt((1-e)/(1+e))*Math.tan(th/2)));
	var f2=(e*Math.sqrt(1-e*e)*Math.sin(th))/(1+e*Math.cos(th));
	var f=(f1-f2)*ty/2/Math.PI;
	if(flag==1) f=ty-f;
	if(flag==2) f=2*ty-f;
	peri[i]=f;
}
for(i=ini;i<=(ini+num);i++){
	jdez[i]=jdve+peri[i]-peri[1];
}
return true;
}

function XPerturbation(jdez){
var t=(jdez-2451545)/36525;
var s=0;
for(k=0;k<=23;k++){
	s=s+ptsa[k]*Math.cos(ptsb[k]*2*Math.PI/360+ptsc[k]*2*Math.PI/360*t);
}
var w=35999.373*t-2.47;
var l=1+0.0334*Math.cos(w*2*Math.PI/360)+0.0007*Math.cos(2*w*2*Math.PI/360);
var ptb=0.00001*s/l;
return ptb;
}

function XDeltaT(yy , mm ){
var u, t, dt, y;
y = yy + (mm - 0.5) / 12;

if(y<=-500){	
	u = (y - 1820) / 100;
	dt = (-20 + 32*u*u);}
else{if(y< 500){
	u = y / 100;
	dt=(10583.6-1014.41*u+33.78311*u*u-5.952053*u*u*u-0.1798452*u*u*u*u+0.022174192*u*u*u*u*u+0.0090316521*u*u*u*u*u*u);}
else{if(y<1600){
	u = (y - 1000) / 100;
	dt = (1574.2-556.01*u+71.23472*u*u+0.319781*u*u*u-0.8503463*u*u*u*u-0.005050998*u*u*u*u*u+ 0.0083572073*u*u*u*u*u*u);}
else{if(y<1700){
	t = y - 1600;
	dt = (120 - 0.9808 * t - 0.01532 * t*t + t*t*t / 7129);}
else{if(y<1800){
	t = y - 1700;
	dt = (8.83 + 0.1603 * t - 0.0059285 * t*t + 0.00013336 * t*t*t - t*t*t*t / 1174000);}
else{if(y<1860){
	t = y - 1800;
	dt=(13.72-0.332447*t+0.0068612*t*t+0.0041116*t*t*t-0.00037436*t*t*t*t+0.0000121272*t*t*t*t*t-0.0000001699*t*t*t*t*t*t+ 0.000000000875*t*t*t*t*t*t*t);}
else{if(y<1900){
	t = y - 1860;
	dt = (7.62 + 0.5737 * t - 0.251754 * t*t + 0.01680668 * t*t*t - 0.0004473624 * t*t*t*t + t*t*t*t*t / 233174);}
else{if(y<1920){
	t = y - 1900;
	dt = (-2.79 + 1.494119 * t - 0.0598939 * t*t + 0.0061966 * t*t*t - 0.000197 * t*t*t*t);}
else{if(y<1941){
	t = y - 1920;
	dt = (21.2 + 0.84493 * t - 0.0761 * t*t + 0.0020936 * t*t*t);}
else{if(y<1961){
	t = y - 1950;
	dt = (29.07 + 0.407 * t - t*t / 233 + t*t*t / 2547);}
else{if(y<1986){
	t = y - 1975;
	dt = (45.45 + 1.067 * t - t*t / 260 - t*t*t / 718);}
else{if(y<2005){
	t = y - 2000;
	dt = (63.86 + 0.3345 * t - 0.060374 * t*t + 0.0017275 * t*t*t + 0.000651814 * t*t*t*t + 0.00002373599 * t*t*t*t*t);}
else{if(y<2050){
	t = y - 2000;
	dt = (62.92 + 0.32217 * t + 0.005589 * t*t);}
else{if(y<2150){
	u = (y - 1820) / 100;
	dt = (-20 + 32*u*u-0.5628*(2150 - y));}
else{
	u = (y - 1820) / 100;
	dt = (-20 + 32*u*u);}}}}}}}}}}}}}}

if(y<1955 || y>=2005) dt=dt-(0.000012932*(y-1955)*(y-1955));
var DeltaT = dt / 60;    //將秒轉換為分
return DeltaT
}

function XJtime(op,jd){//&#23558;儒略日&#36716;&#25442;&#20026;年月日&#26102;分秒
if(jd>=2299160.5 || op){
	var y4h=146097;
	var init=1721119.5;
}
else{
	var y4h=146100;
	var init=1721117.5;
}
var jdr=Math.floor(jd-init);
var yh=y4h/4;
var cen=Math.floor((jdr+0.75)/yh);
var d=Math.floor(jdr+0.75-cen*yh);
var ywl=1461/4;
var jy=Math.floor((d+0.75)/ywl);
d=Math.floor(d+0.75-ywl*jy+1);
var ml=153/5;
mp=Math.floor((d-0.5)/ml);
d=Math.floor((d-0.5)-30.6*mp+1);
var y=(100*cen)+jy;
var m=(mp+2)%12+1;
if(m<3) y=y+1;
var sd=Math.floor((jd+0.5-Math.floor(jd+0.5))*24*60*60+0.00005);
var mt=Math.floor(sd/60);
var ss=sd%60;
var hh=Math.floor(mt/60);
var mmt=mt%60;
var yy=Math.floor(y);
var mm=Math.floor(m);
var dd=Math.floor(d);
var yc="     "+yy;
yc=yc.substr(yc.length-5,5);
var dytm=yc;dytm+="年";
dytm+= ((mm < 10) ? "0" : "") + mm+"月";
dytm+= ((dd < 10) ? "0" : "") + dd+"日";
dytm+= ((hh < 10) ? "0" : "") + hh+"時&#26102;";
dytm+= ((mmt < 10) ? "0" : "") + mmt+"分";
dytm+= ((ss < 10) ? "0" : "") + ss+"秒";
var mmt =  ((mm < 10) ? "0" : "") + mm;
var ddt =  ((dd < 10) ? "0" : "") + dd;
 //return dytm;
   //return dd;
  return  (yy+"/"+ mmt+"/"+ ddt);
 // document.Write(yy+"/"+ mmt+"/"+ ddt);
}

//副程式功能：對Perturbaton作調整後的自春分點開始的24節氣,可只取部份
function XGetAdjustedJQ(yy, ini, num, jdjq){
var veb=XVE(yy);
var ty=XVE(yy+1)-veb;     //求指定年的春分點及回歸年長
if(XMeanJQJD(yy,veb,ty,ini,num)==true){	//輸入指定年,JD,回歸年長,求該回歸年各節氣之長
		for(i=ini+1;i<=(ini+num);i++){
			ptb=XPerturbation(jdez[i]);	//取得受perturbation影響所需微調
			dt=XDeltaT(yy,Math.floor(i/2)+3);	//修正dynamical time to Universal time
			jdjq[i]=jdez[i]+ptb-dt/60/24;	//加上攝動調整值ptb，減去對應的Delta T值(分鐘轉換為日)
			jdjq[i]=jdjq[i]+1/3;	//因中國時間比格林威治時間先行8小時，即1/3日
		}
	}

}

//副程式功能：求出以立春點開始的不含中氣之12節氣
function XGetPureJQsinceSpring(yy, ptsa,ptsb,ptsc, jdpjq){
var sjdjq=new Array;
var yea = yy - 1;
//GetAdjustedJQ(yea, 21, 3, sjdjq);   //求出含指定年立春開始之3個節氣JD值,以前一年的年值代入
//轉移春分前之立春至驚蟄之節氣至jdpjq變數中，以重整index
//jdpjq[0] =sjdjq[22]; jdpjq[1] =sjdjq[24];   //原此為立春 //此為驚蟄
 XGetAdjustedJQ(yea, 19, 5, sjdjq);   //求出含指定年小寒開始之5個節氣JD值,以前一年的年值代入
jdpjq[0] =sjdjq[20];                     
jdpjq[1] =sjdjq[21]; 
jdpjq[2] =sjdjq[22];                     
jdpjq[3] =sjdjq[23];
jdpjq[4] =sjdjq[24];

yea = yy;
XGetAdjustedJQ(yea, 0, 26, sjdjq);       //求出指定年節氣之JD值,從驚蟄開始，到雨水
//轉移春分至小寒之節氣至jdpjq變數中，以重整index
//for(i=1;i<=13;i++){
    //jdpjq[i+1] = sjdjq[2 * i];
    for(i=1;i<=20;i++){
    jdpjq[i+4] = sjdjq[i];
 }
}

</script>
 
 </HEAD> 
   <style>.MoveColor {
        			BACKGROUND-COLOR: aqua;
					}
	</style>
<body bgcolor= #99FFCC text="#000000" onload=initialize() >
 <!--<body  text="#000000" onload=initialize() >-->
<div align="center"> 
  
 <!-- <table border=0 cellpadding=0 cellspacing=0 width=590 height="327">-->
    
          <form name="CLD">
                 <div >
                      <tr bgcolor= #0000FF >
                       <td ><FONT color="#ff00ff" id=CHSND size=5>
                        </FONT></td></tr>
                      <tr bgcolor= #0000FF >
                       <td ><FONT color="#ff00ff" id=CHSGD size=5>
                        </FONT></td></tr>
                      </div>
                <div align="center"> 
                  <table width="560" align="center" border="0" >
                     <tbody> 
                      
                      
                      
                    <tr  align="center"  valign="top"> 
                      <td colspan=7 height="18"><font color=#0000ff size=3 
            style="FONT-SIZE: 12pt"> </font> 
                        <table width="465" border="0" height="15" align="center" >
                          <tr> 
                            <td align="center" bgcolor="#000080" height="15" width="460" valign="top" bordercolor="#333333"><font  size=3 
                        style="FONT-SIZE: 11pt"> 
                              <input type="button" name="Ybta"onClick="pushBtm('YD')" value="▼">
                              <select name=SY onChange=changeCld() 
                      style="FONT-SIZE: 11pt">
     <script language=JavaScript><!--
         //for (i = 1912; i < 2072; i++)
         for (i = 1912; i < 2973; i++)
 		   document.write('<option>'+i+'(民國'+((i-1911)==1?'元':(i-1911))+')');
		            //--></script>
                              </select>
                              <font size=3 style="FONT-SIZE: 12pt"> 
                              <input type="button" name="Ybtd" onClick="pushBtm('YU')" value="▲">
                              </font><font size="3" >年</font> 
                              <input type="button" name="Mbta"onClick="pushBtm('MD')" value="▼">
                              <select name=SM onChange=changeCld() 
            style="FONT-SIZE: 11pt">
                                <script language=JavaScript><!--
          for(i=1;i<13;i++) document.write('<option>'+i)
          //--></script>
                              </select>
                              <input type="button" name="Mbtd" onClick="pushBtm('MU')" value="▲">
                              <font size="3">月</font> 
                              <input type="button" name="Today" onClick="pushBtm('')" value="今天">
                              </font>
                            </td>
                          </tr>
                         </table>
                        <div align="center" ><FONT color="#ff00ff" id=Ndz size=3></FONT> 
                          <FONT color=#ff00ff id=Ldz size=3></FONT> <br>
                          <FONT color=#ffooff id=Ldzx size=3></FONT> </div>
                      
                    <tr align=center bgcolor="#00FFFF" > 
                      <td width=60 height="19"><b><font color="#FF0000">星期日</font></b></td>
                      <td width=60 height="19"><b>星期一</b></td>
                      <td width=60 height="19"><b>星期二</b></td>
                      <td width=60 height="19"><b>星期三</b></td>
                      <td width=60 height="19"><b>星期四</b></td>
                      <td width=60 height="19"><b>星期五</b></td>
                      <td width=60 height="19"><b><font color="#FF0000">星期六</font></b></td>
                    </tr>
                    <script language=JavaScript><!--
          var gDay;
          for(i=0;i<6;i++) {
             document.write('<tr align=center>')
             for(j=0;j<7;j++) {
                gDay = i*7+j
				 document.write('<td id="GD' + gDay +'" onMouseDown="mDown(' + gDay +')"><font id="SD' + gDay +'" size=5 face="Arial Black"');
                if((j == 0) || (j == 6) ) document.write(' color=red');
              document.write(' TITLE=""></font><br><font id="LD' + gDay + '"size=3 style="font-size:10pt"> ')
        		document.write(' </font><br><font id="DZ' + gDay + '"size=3 style="font-size:10pt"> </font></td>')
		     }
             document.write('</tr>')
          }
     //--></script>
             
             </td>
          </tr>
        </table>
          </tbody> 

        </form>
     </div>
</body>
</html>
